#!/bin/sh
set -eu
msgfile="$1"

# Append below the scissors line area (safe; ignored by Git)
{
  echo
  echo "# --- word-diff (staged) ---"
  git diff --cached --word-diff=plain
} >>"$msgfile"

# #!/bin/sh
# set -eu
#
# msgfile="$1"
# scissors='^# ------------------------ >8 ------------------------'
#
# tmp="$(mktemp)"
#
# # Keep everything up to (and including) the scissors line; drop the rest (the default -v diff)
# if grep -qE "$scissors" "$msgfile"; then
#   awk -v re="$scissors" '
#     { print }
#     $0 ~ re { exit }
#   ' "$msgfile" >"$tmp"
# else
#   # If no scissors line, keep file and add one (safety), so anything we append won't be committed.
#   cat "$msgfile" >"$tmp"
#   {
#     echo "# ------------------------ >8 ------------------------"
#     echo "# Do not modify or remove the line above."
#     echo "# Everything below it will be ignored."
#   } >>"$tmp"
# fi
#
# mv "$tmp" "$msgfile"
#
# # Append word-diff only (commented for extra safety)
# {
#   echo
#   echo "# --- word-diff (staged) ---"
#   git diff --cached --word-diff=plain | sed 's/^/# /'
# } >>"$msgfile"
#
